
## Docker Images & Containers â€“ Listing and Filtering

## 1ï¸âƒ£ View Local Docker Images
Shows all images downloaded and stored locally on the system.
$ docker images
Modern (recommended) form:
$ docker image ls
* Both commands show the **same output**
* `docker image ls` follows Dockerâ€™s newer object-based CLI style


## 2ï¸âƒ£ List Docker Containers
### Show all containers (running + stopped)
$ docker ps -a
Modern (recommended) form:
$ docker container ls -a
* `-a` â†’ shows **all containers**, including:
  * Running
  * Exited
  * Created
Without `-a`, only **running containers** are displayed.

---

## 3ï¸âƒ£ Filter Containers by <key>=<value>
### Show only exited containers
Syntax:
docker container ls -a -f <key>=<value>

Filter using 'status'
$ docker container ls -a -f status=exited
* `-f` â†’ apply a filter
* `status=exited` â†’ show containers that are stopped and exited

other examples:
docker container ls -a -f name=web
docker container ls -a -f id=c75df2
docker container ls -a -f before=mysite1
docker container ls -a -f status=exited -f ancestor=nginx -q      # Adding two filters.
---

## 4ï¸âƒ£ Display Only Container IDs
### Get IDs of exited containers (useful for cleanup)
$ docker container ls -a -f status=exited -q
* `-q` â†’ quiet mode (prints only container IDs)
* Commonly used with commands like:
$ docker container rm $(docker container ls -a -f status=exited -q)


---

## ğŸ§  Key Takeaways
* `docker image ls` â†’ list local images
* `docker container ls -a` â†’ list all containers
* `-a` â†’ include stopped/hidden containers, Otherwise you will only see 'running' containers. 
* `-f` â†’ filter output
* `-q` â†’ return only container IDs

--------------------------------------------------------------------------------------------------

## Docker Cleanup â€“ Removing Containers and Images
## 1ï¸âƒ£ Removing Containers (Core Lifecycle Rule)
### Stop a Running Container
$ docker container stop <container-id | container-name>
* Gracefully stops a running container
* Sends SIGTERM, then SIGKILL after timeout
* A container must be **stopped** before normal removal

### Remove a Stopped Container
$ docker container rm <container-id | container-name>
* Permanently deletes the container
* Container must be in `Exited` or `Created` state

### Force Remove a Running Container
$ docker container rm -f <container-id | container-name>
* Stops and removes the container in one step
* Use only when graceful stop is not required
âš ï¸ Use with caution in production environments

---

## 2ï¸âƒ£ Removing Multiple Containers (Bulk Cleanup)
### Remove All Exited Containers
$ docker container rm $(docker container ls -a -f status=exited -q)
* `-f status=exited` â†’ filters stopped containers
* `-q` â†’ returns only container IDs
* Command substitution removes all exited containers at once


## 3ï¸âƒ£ Container vs Image Dependency Rule (Very Important)

> **Containers must be removed before their images can be deleted.**
* Images cannot be removed if **any container exists** using them
* This applies even if the container is stopped

Correct order:
Container â†’ Image


## 4ï¸âƒ£ Removing Images
### Remove an Image (Safe)
$ docker image rmi <image-name | image-id>
* Removes the specified image
* Fails if containers still reference the image

### Force Remove an Image
$ docker image rmi -f <image-name | image-id>
* Forces image removal
* Can remove images with stopped containers referencing them
âš ï¸ Use with caution

---

## ğŸ§  Mental Model Summary
* Containers depend on images
* Images do not depend on containers
* Removal order always matters

Flow :>
Stop â†’ Remove Container â†’ Remove Image
---

# Dangling Images:
Docker images consist of multiple layers. Dangling images are layers that have no relationship to any tagged images.
To delete dangling images, stopped containers and networks not used by at least one container
run $ docker system prune

To remove unused images as well
$ docker system prune -a
* This will also delete the build cache. 




---

## âœ… Exam & Real-World Takeaway

> Docker enforces dependency order: containers must be stopped and removed before the associated image can be deleted.

